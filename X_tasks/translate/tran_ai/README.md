# 项目需求

概述：多语言版本博客文档翻译
Batch file translation by Vertex AI gemini

- 开发程序语言：python，请给程序逐行写英文注释；

- api：Google云计算，Vertex AI api，可定义使用的具体ai模型（Gemini pro/ ultra）；

备注：此前调用google translation api的方法已经过时了，因为该api不识别文档格式的语法标记，导致被翻译后的文件格式混乱。为了避免这种恶劣情况，需要在程序中定义文件格式语法标记，告诉翻译api哪些文本是可翻译，哪些是保留的标记，这增加了代码工作量；

- 源语言lan_source：此为源文件内容的人类自然语言版本（语言标签），程序通过ai自动识别源语言类别，也可在程序中定义，例如在程序中定义 lan_source = "zh-TW"；

- 语言标签： Vertex AI API 的多语种翻译功能使用 BCP 47 语言标签作为输入和输出的语言标识符，主要组成部分是ISO 639 标准中的语言代码，和ISO 3166 标准中的地区代码，例如 zh-TW台湾正体。

- 目标语言lan_target：把源文件内容翻译成我们想要的其他人类自然语言版本，文件的目录名称定义了目标语言，例如目录名 en 英文，de 德文，目录名并不一定与语言标签完全一致，例如目录zhs中文简体（语言标签 zh-CN ），en英文（不区分en-US美国英语 和 en-GB英国英语）；

- 源文件目录中可能有多级子目录、子文件等等，ai模型应该能识别并逐个检索并完成全部文件的翻译；

- 全部的目标语言目录及其文件结构与源语言目录保持一致，文件名也都是一样的，仅仅是目录名（en，de，zhs）不同。

- 本项目处理多语言版本的博客文件，在目标语言目录中持续有新的源语言文件，程序应跳过已经翻译成目标语言的文件，仅仅翻译新的源语言文件。例如en目录中大部分都是英文版本内容的文件，但是持续有源语言zh-TW的文件被添加进去，每次运行程序将其批量翻译成目标语言en。

- 程序会直接将翻译后的内容覆盖到目标语言目录中对应的源语言文件中，而不需要从源语言目录中复制文件到目标语言目录中。

- 程序应该检查文件内容的语言版本与所在目录的目标语言是否一致，若不一致，则需要翻译，而不是根据文件名与源语言目录是否一致来判断，因为所有的目录中文件结构和文件名都是一样的。



# 文件格式
- 源文件格式：根据文件名后缀判断文件格式，如.md, .yaml, .xml等等。例如文件名以.md结尾，filename.md，属于markdown格式；
- 多格式并存：可能需要同时处理多种混合格式的文件，但是为了提高效率，我们尽可能每次只处理同一种格式文件；
- 自动检测文件格式：确保ai模型能理解不同格式的语法标记，根据格式类型选择相应的处理方案，能保留源文件格式，这是最重要的ai模型能力；


# 翻译内容特别注意事项
- 文件格式的语法标记是不可翻译的，例如md文件中带有markdown格式标记，必须保留翻译后的文件与源文件相同的格式；
- 引用圣经、名言、人名、地名、图书、电影名称、汉语成语和寓言等应该保留一份原文的源语言，同时一份对应翻译的目标语言；
- 文件目录名、文件名不要翻译，因为作为最终网页url的一部分，应始终保持其英文语言版本；


# prompt 提示词

* 告诉gemini，正在处理的文件的格式，例如 markdown、YAML、XML/HTML和 JSON，应一丝不苟地保留文件原始格式。
* 不要添加任何额外的解释、上下文、示例，只提供与目标目录文件中的源内容相关的翻译文本。
* 尽可能保持文本的原始语气和风格，注意文化差异，在适当的情况下避免直译。
* 保持一致的翻译标准和惯例。例如处理命名实体（圣经、名言、人名、地点、书名、电影名称、中文成语典故和歇後語）时，同时保留原文和译文。
将原文后跟译文，如下所示：“[original_text]translate_text”。例如，中文翻译为英文：“[狐假虎威]The fox exploits the tiger's might”。
